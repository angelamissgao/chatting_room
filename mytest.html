<!DOCTYPE html>
<html>
    <head>
      <link type="text/css" rel="stylesheet" href="/static/style.css">
        <title>CMU chatting room</title>
        
        <!--bootstramp import-->
          <meta charset="utf-8">
          <meta name="viewport" content="width=device-width, initial-scale=1">
          <link rel="stylesheet" href="/static/bootstrap-3.3.5-dist/css/bootstrap.min.css">
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
          
    

    </head>
    
    <body>
        <!-- This is the Header-->
        <div id="header" >
        <h1>Beeper Calmels</h1>
        <img id="header_img" class="img " src="/static/images/u2.png">
            <p>Find Your Colleagues with Our Online Chatting Tool</P>
        </div>
    
        <!-- this is the on-line name list-->
        <div id="namelist" class="panel panel-info">
            <table>
          <tr>
          <td> student names</td>
        </table>
        </div>

        <!-- this is the Chatting tool-->
        <div class="panel panel-info" id="chattingtool">
            <div class="panel-heading"> Messages:    </div>
                <div class="panel-body">
                <ul id="messages"></ul>
               </div>
        </div>
  
        <!-- this is the message sending box-->
        <div class="well well-lg">
            <form action="">
            <input id="m" autocomplete="off" /><button class="btn btn-success">Send</button>
            </form>
        </div>

        <!-- this is the footer-->
      <div id="footer">
        <img id="footer_img" class="img " src="/static/images/u10.png">
        <p>Copyright @ Angela Gao</p>
        </div>

       <!-- this is the script and libraty imported-->
        <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
        <script src="/static/jquery.cookie.js"> </script>
        <script>
          var socket = io.connect();         
          
          $('form').submit(function(){
              socket.emit('tweet',{msg:$('#m').val(), username: $.cookie('username')});
              $('#m').val('');
              return false;
          });

          socket.on('chat message', function(tweet){
              var msgtime = new Date(tweet.time);

              $('#messages').append( 
                $('<li>').text( tweet.username+":"+tweet.msg+"   "+msgtime.toLocaleDateString()+"   "+msgtime.toLocaleTimeString() )
              );
          });

          socket.on('stream', function(stream){
                var msgtimeST= new Date(stream.posted_on);
                $('#messages').append( 
                  $('<li>').text( stream.username+":"+stream.message+"   "+msgtimeST.toLocaleDateString()+"   "+msgtimeST.toLocaleTimeString()  )
                );
          });

          // socket.on('connect',function(){
          //     socket.emit('adduser',prompt("what's your name?"));
          // });

          // var userList=[];
          
          // socket.on('update',function(users){
            
          //   userList = users;
          //   $('#namelist').empty();
          //   for( var i=0; i<userList.length; i++){
          //     $('namelist').append("<h2>"+userList[i]+"</h2>");
          //   }
          // });

        </script>


    </body>
</html>